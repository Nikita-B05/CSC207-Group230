Index: src/main/java/data_access/MongoDBUserDataAccessObject.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package data_access;\r\n\r\nimport java.util.ArrayList;\r\nimport java.util.Objects;\r\nimport java.util.Optional;\r\n\r\nimport com.mongodb.client.MongoCollection;\r\nimport com.mongodb.client.model.Filters;\r\nimport com.mongodb.client.model.Updates;\r\nimport converters.EntityConverter;\r\nimport converters.EntityConverterInterface;\r\nimport entity.*;\r\nimport org.bson.Document;\r\n\r\nimport use_case.change_password.ChangePasswordUserDataAccessInterface;\r\nimport use_case.homepage.HomepageUserDataAccessInterface;\r\nimport use_case.login.LoginUserDataAccessInterface;\r\nimport use_case.logout.LogoutUserDataAccessInterface;\r\nimport use_case.settings.SettingsUserDataAccessInterface;\r\nimport use_case.signup.SignupUserDataAccessInterface;\r\nimport use_case.choose_avatar.ChooseAvatarUserDataAccessInterface;\r\nimport use_case.input_name.InputNameUserDataAccessInterface;\r\n\r\n/**\r\n * The DAO for user data, now using MongoDB.\r\n */\r\npublic class MongoDBUserDataAccessObject implements SignupUserDataAccessInterface,\r\n        LoginUserDataAccessInterface,\r\n        ChangePasswordUserDataAccessInterface,\r\n        ChooseAvatarUserDataAccessInterface,\r\n        InputNameUserDataAccessInterface,\r\n        LogoutUserDataAccessInterface,\r\n        HomepageUserDataAccessInterface,\r\n        SettingsUserDataAccessInterface {\r\n\r\n    private static final String USERNAME = \"username\";\r\n    private static final String PASSWORD = \"password\";\r\n    private static final String DARK_MODE = \"darkMode\";\r\n    private static final String CHARACTER_NAME = \"characterName\";\r\n    private static final String AVATAR = \"avatar\";\r\n    private static final String HAPPINESS = \"happiness\";\r\n    private static final String SALARY = \"salary\";\r\n    private static final String ASSETS = \"assets\";\r\n    private static final String LIABILITIES = \"liabilities\";\r\n    private static final String DECISIONS = \"decisions\";\r\n\r\n    private final UserFactory userFactory;\r\n    private final MongoDBConnection mongoDBConnection;\r\n    private final EntityConverterInterface converter;\r\n    private String currentUsername = null;\r\n\r\n    public MongoDBUserDataAccessObject(UserFactory userFactory) {\r\n        this.userFactory = userFactory;\r\n        this.mongoDBConnection = new MongoDBConnection();\r\n        this.converter = new EntityConverter();\r\n    }\r\n\r\n    @Override\r\n    public User get(String username) {\r\n        if (username == null || username.isEmpty()) {\r\n            throw new IllegalArgumentException(\"Username cannot be null or empty\");\r\n        }\r\n        MongoCollection<Document> usersCollection = mongoDBConnection.getCollection();\r\n\r\n        Document userDoc = usersCollection.find(Filters.eq(USERNAME, username)).first();\r\n\r\n        if (userDoc != null) {\r\n            String name = userDoc.getString(USERNAME);\r\n            String password = userDoc.getString(PASSWORD);\r\n            boolean isDarkMode = userDoc.getBoolean(DARK_MODE, false);\r\n            String characterName = userDoc.getString(CHARACTER_NAME);\r\n            Avatar avatar = converter.toAvatar(userDoc.getString(AVATAR));\r\n            int happiness = userDoc.getInteger(HAPPINESS);\r\n            int salary = userDoc.getInteger(SALARY);\r\n            Assets assets = converter.toAssets(userDoc.getString(ASSETS));\r\n            Liabilities liabilities = converter.toLiabilities(userDoc.getString(LIABILITIES));\r\n            ArrayList<Decision> decisions = converter.toArrayListOfDecision(userDoc.getString(DECISIONS));\r\n\r\n            return userFactory.create(\r\n                    name,\r\n                    password,\r\n                    isDarkMode,\r\n                    characterName,\r\n                    avatar,\r\n                    happiness,\r\n                    salary,\r\n                    assets,\r\n                    liabilities,\r\n                    decisions\r\n            );\r\n        } else {\r\n            throw new RuntimeException(\"User not found\");\r\n        }\r\n    }\r\n\r\n    @Override\r\n    public void setCurrentUsername(String name) {\r\n        if (name != null && name.isEmpty()) {\r\n            throw new IllegalArgumentException(\"Current username cannot be an empty string\");\r\n        }\r\n        this.currentUsername = name;\r\n    }\r\n\r\n    @Override\r\n    public void updateUserDarkMode(boolean isDarkMode) {\r\n        User user = getCurrentUser();\r\n        updateUser(user, DARK_MODE, isDarkMode);\r\n    }\r\n\r\n    @Override\r\n    public void updateCharacterName(String characterName) {\r\n        User user = getCurrentUser();\r\n        updateUser(user, CHARACTER_NAME, characterName);\r\n    }\r\n\r\n    @Override\r\n    public void updateAvatar(Avatar avatar) {\r\n        User user = getCurrentUser();\r\n        updateUser(user, AVATAR, avatar);\r\n    }\r\n\r\n    @Override\r\n    public String getCurrentUsername() {\r\n        if (currentUsername == null) {\r\n            throw new IllegalStateException(\"No current user is set\");\r\n        }\r\n        return currentUsername;\r\n    }\r\n\r\n    @Override\r\n    public User getCurrentUser() {\r\n        if (currentUsername == null) {\r\n            throw new IllegalStateException(\"No current user is logged in\");\r\n        }\r\n        return get(currentUsername);\r\n    }\r\n\r\n    @Override\r\n    public void save(User user) {\r\n        MongoCollection<Document> usersCollection = mongoDBConnection.getCollection();\r\n\r\n        Document userDoc = new Document()\r\n                .append(USERNAME, user.getUsername())\r\n                .append(PASSWORD, user.getPassword())\r\n                .append(DARK_MODE, user.isDarkMode())\r\n                .append(CHARACTER_NAME, user.getCharacterName())\r\n                .append(AVATAR, converter.serialize(user.getAvatar()))\r\n                .append(HAPPINESS, user.getHappiness())\r\n                .append(SALARY, user.getSalary())\r\n                .append(ASSETS, converter.serialize(user.getAssets()))\r\n                .append(LIABILITIES, converter.serialize(user.getLiabilities()))\r\n                .append(DECISIONS, converter.serialize(user.getDecisions()));\r\n\r\n        usersCollection.insertOne(userDoc);\r\n    }\r\n\r\n    @Override\r\n    public void changePassword(User user) {\r\n        updateUser(user, PASSWORD, user.getPassword());\r\n    }\r\n\r\n//    @Override\r\n    public void updateUserDarkMode(User user) {\r\n        updateUser(user, DARK_MODE, user.isDarkMode());\r\n    }\r\n\r\n    private void updateUser(User user, String key, Object value) {\r\n        MongoCollection<Document> usersCollection = mongoDBConnection.getCollection();\r\n\r\n        if (Objects.equals(key, AVATAR)) {\r\n            if (!(value instanceof Avatar)) {\r\n                throw new IllegalArgumentException(\"Class of <value> must be equal to <key>.\");\r\n            }\r\n            usersCollection.updateOne(\r\n                    Filters.eq(USERNAME, user.getUsername()),\r\n                    Updates.set(key, converter.serialize((Avatar) value))\r\n            );\r\n        }\r\n        else if (Objects.equals(key, ASSETS)) {\r\n            if (!(value instanceof Assets)) {\r\n                throw new IllegalArgumentException(\"Class of <value> must be equal to <key>.\");\r\n            }\r\n            usersCollection.updateOne(\r\n                    Filters.eq(USERNAME, user.getUsername()),\r\n                    Updates.set(key, converter.serialize((Assets) value))\r\n            );\r\n        }\r\n        else if (Objects.equals(key, LIABILITIES)) {\r\n            if (!(value instanceof Liabilities)) {\r\n                throw new IllegalArgumentException(\"Class of <value> must be equal to <key>.\");\r\n            }\r\n            usersCollection.updateOne(\r\n                    Filters.eq(USERNAME, user.getUsername()),\r\n                    Updates.set(key, converter.serialize((Liabilities) value))\r\n            );\r\n        }\r\n        else if (Objects.equals(key, DECISIONS)) {\r\n            if (!(value instanceof ArrayList)) {\r\n                throw new IllegalArgumentException(\"Class of <value> must be equal to <key>.\");\r\n            }\r\n            for (Object o : (ArrayList) value) {\r\n                if (!(o instanceof Decision)) {\r\n                    throw new IllegalArgumentException(\"Value is not an ArrayList of Decision.\");\r\n                }\r\n            }\r\n            usersCollection.updateOne(\r\n                    Filters.eq(USERNAME, user.getUsername()),\r\n                    Updates.set(key, converter.serialize((ArrayList<Decision>) value))\r\n            );\r\n        } else {\r\n            usersCollection.updateOne(\r\n                    Filters.eq(USERNAME, user.getUsername()),\r\n                    Updates.set(key, value)\r\n            );\r\n        }\r\n    }\r\n\r\n    @Override\r\n    public boolean existsByName(String username) {\r\n        MongoCollection<Document> usersCollection = mongoDBConnection.getCollection();\r\n\r\n        Optional<Document> userDoc = Optional.ofNullable(usersCollection.find(Filters.eq(USERNAME, username)).first());\r\n\r\n        return userDoc.isPresent();\r\n    }\r\n\r\n    private void deleteUser(String user) {\r\n        MongoCollection<Document> usersCollection = mongoDBConnection.getCollection();\r\n        usersCollection.deleteMany(Filters.eq(USERNAME, user));\r\n    }\r\n\r\n    public static void main(String[] args) {\r\n        User user = new CommonUser(\"Test\", \"1234\");\r\n        MongoDBUserDataAccessObject dao = new MongoDBUserDataAccessObject(new CommonUserFactory());\r\n        dao.save(user);\r\n        System.out.println(dao.get(user.getUsername()).getSalary());\r\n        dao.deleteUser(user.getUsername());\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/data_access/MongoDBUserDataAccessObject.java b/src/main/java/data_access/MongoDBUserDataAccessObject.java
--- a/src/main/java/data_access/MongoDBUserDataAccessObject.java	(revision ef90e6a15318dc37b0d101cfdc55f43b740936a3)
+++ b/src/main/java/data_access/MongoDBUserDataAccessObject.java	(date 1732938731597)
@@ -159,7 +159,7 @@
         updateUser(user, PASSWORD, user.getPassword());
     }
 
-//    @Override
+    //    @Override
     public void updateUserDarkMode(User user) {
         updateUser(user, DARK_MODE, user.isDarkMode());
     }
Index: src/main/java/data_access/DBUserDataAccessObject.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package data_access;\r\n\r\nimport java.io.IOException;\r\nimport java.util.ArrayList;\r\n\r\nimport converters.EntityConverterInterface;\r\nimport converters.EntityConverter;\r\nimport entity.*;\r\nimport org.json.JSONException;\r\nimport org.json.JSONObject;\r\n\r\nimport okhttp3.MediaType;\r\nimport okhttp3.OkHttpClient;\r\nimport okhttp3.Request;\r\nimport okhttp3.RequestBody;\r\nimport okhttp3.Response;\r\nimport use_case.change_password.ChangePasswordUserDataAccessInterface;\r\nimport use_case.homepage.HomepageUserDataAccessInterface;\r\nimport use_case.login.LoginUserDataAccessInterface;\r\nimport use_case.logout.LogoutUserDataAccessInterface;\r\nimport use_case.signup.SignupUserDataAccessInterface;\r\n\r\n/**\r\n * The DAO for user data.\r\n */\r\npublic class DBUserDataAccessObject implements SignupUserDataAccessInterface,\r\n        LoginUserDataAccessInterface,\r\n        ChangePasswordUserDataAccessInterface,\r\n        LogoutUserDataAccessInterface,\r\n        HomepageUserDataAccessInterface\r\n{\r\n    private static final int SUCCESS_CODE = 200;\r\n    private static final String CONTENT_TYPE_LABEL = \"Content-Type\";\r\n    private static final String CONTENT_TYPE_JSON = \"application/json\";\r\n    private static final String STATUS_CODE_LABEL = \"status_code\";\r\n    private static final String USERNAME = \"username\";\r\n    private static final String PASSWORD = \"password\";\r\n    private static final String INFO = \"info\";\r\n    private static final String DARK_MODE = \"darkMode\";\r\n    private static final String CHARACTER_NAME = \"characterName\";\r\n    private static final String AVATAR = \"avatar\";\r\n    private static final String HAPPINESS = \"happiness\";\r\n    private static final String SALARY = \"salary\";\r\n    private static final String ASSETS = \"assets\";\r\n    private static final String LIABILITIES = \"liabilities\";\r\n    private static final String DECISIONS = \"decisions\";\r\n\r\n    private static final String MESSAGE = \"message\";\r\n    private final UserFactory userFactory;\r\n    private final EntityConverterInterface converter;\r\n\r\n    public DBUserDataAccessObject(UserFactory userFactory) {\r\n        this.userFactory = userFactory;\r\n        this.converter = new EntityConverter();\r\n        // No need to do anything to reinitialize a user list! The data is the cloud that may be miles away.\r\n    }\r\n\r\n    @Override\r\n    public User get(String username) {\r\n        // Make an API call to get the user object.\r\n        final OkHttpClient client = new OkHttpClient().newBuilder().build();\r\n        final Request request = new Request.Builder()\r\n                .url(String.format(\"http://vm003.teach.cs.toronto.edu:20112/user?username=%s\", username))\r\n                .addHeader(\"Content-Type\", CONTENT_TYPE_JSON)\r\n                .build();\r\n        try {\r\n            final Response response = client.newCall(request).execute();\r\n\r\n            final JSONObject responseBody = new JSONObject(response.body().string());\r\n\r\n            if (responseBody.getInt(STATUS_CODE_LABEL) == SUCCESS_CODE) {\r\n                final JSONObject userJSONObject = responseBody.getJSONObject(\"user\");\r\n\r\n                String dbUsername = userJSONObject.has(USERNAME) ? userJSONObject.getString(USERNAME) : username;\r\n\r\n                final String password = userJSONObject.has(PASSWORD) ? userJSONObject.getString(PASSWORD) : null;\r\n\r\n                if (!userJSONObject.has(INFO) || userJSONObject.isNull(INFO)) {\r\n                    return userFactory.create(dbUsername, password);\r\n                }\r\n                JSONObject infoJSON = userJSONObject.getJSONObject(INFO);\r\n\r\n                final boolean isDarkMode = infoJSON.has(DARK_MODE) ? infoJSON.getBoolean(DARK_MODE) : false;\r\n\r\n                final String characterName = infoJSON.has(CHARACTER_NAME) ?\r\n                        infoJSON.getString(CHARACTER_NAME) : null;\r\n\r\n                Avatar avatar = new Avatar();\r\n                if (infoJSON.has(AVATAR)) {\r\n                    converter.toAvatar(infoJSON.getJSONObject(AVATAR));\r\n                }\r\n\r\n                final int happiness = infoJSON.has(HAPPINESS) ? infoJSON.getInt(HAPPINESS) : 0;\r\n                final int salary = infoJSON.has(SALARY) ? infoJSON.getInt(SALARY) : 0;\r\n\r\n                Assets assets = new Assets();\r\n                if (infoJSON.has(ASSETS)) {\r\n                    converter.toAssets(infoJSON.getJSONObject(ASSETS));\r\n                }\r\n\r\n                Liabilities liabilities = new Liabilities();\r\n                if (infoJSON.has(LIABILITIES)) {\r\n                    converter.toLiabilities(infoJSON.getJSONObject(LIABILITIES));\r\n                }\r\n\r\n                ArrayList<Decision> decisions = new ArrayList<>();\r\n                if (infoJSON.has(DECISIONS)) {\r\n                    decisions = converter.toArrayListOfDecision(infoJSON.getJSONArray(DECISIONS));\r\n                }\r\n\r\n                return userFactory.create(\r\n                        dbUsername,\r\n                        password,\r\n                        isDarkMode,\r\n                        characterName,\r\n                        avatar,\r\n                        happiness,\r\n                        salary,\r\n                        assets,\r\n                        liabilities,\r\n                        decisions\r\n                );\r\n            }\r\n            else {\r\n                throw new RuntimeException(responseBody.getString(MESSAGE));\r\n            }\r\n        }\r\n        catch (IOException | JSONException ex) {\r\n            throw new RuntimeException(ex);\r\n        }\r\n    }\r\n\r\n    @Override\r\n    public void setCurrentUsername(String name) {\r\n        // this isn't implemented for the lab\r\n    }\r\n\r\n    @Override\r\n    public boolean existsByName(String username) {\r\n        final OkHttpClient client = new OkHttpClient().newBuilder()\r\n                .build();\r\n        final Request request = new Request.Builder()\r\n                .url(String.format(\"http://vm003.teach.cs.toronto.edu:20112/checkIfUserExists?username=%s\", username))\r\n                .addHeader(CONTENT_TYPE_LABEL, CONTENT_TYPE_JSON)\r\n                .build();\r\n        try {\r\n            final Response response = client.newCall(request).execute();\r\n\r\n            final JSONObject responseBody = new JSONObject(response.body().string());\r\n\r\n            return responseBody.getInt(STATUS_CODE_LABEL) == SUCCESS_CODE;\r\n        }\r\n        catch (IOException | JSONException ex) {\r\n            throw new RuntimeException(ex);\r\n        }\r\n    }\r\n\r\n    @Override\r\n    public void save(User user) {\r\n        final OkHttpClient client = new OkHttpClient().newBuilder()\r\n                .build();\r\n\r\n        // POST METHOD\r\n        final MediaType mediaType = MediaType.parse(CONTENT_TYPE_JSON);\r\n        final JSONObject requestBody = new JSONObject();\r\n\r\n        requestBody.put(USERNAME, user.getUsername());\r\n        requestBody.put(PASSWORD, user.getPassword());\r\n\r\n        final JSONObject infoBody = new JSONObject();\r\n\r\n        infoBody.put(DARK_MODE, user.isDarkMode());\r\n        infoBody.put(CHARACTER_NAME, user.getCharacterName());\r\n        infoBody.put(AVATAR, converter.toJSONObject(user.getAvatar()));\r\n        infoBody.put(HAPPINESS, user.getHappiness());\r\n        infoBody.put(SALARY, user.getSalary());\r\n        infoBody.put(ASSETS, converter.toJSONObject(user.getAssets()));\r\n        infoBody.put(LIABILITIES, converter.toJSONObject(user.getLiabilities()));\r\n        infoBody.put(DECISIONS, converter.toJSONArray(user.getDecisions()));\r\n\r\n        requestBody.put(INFO, infoBody);\r\n\r\n        final RequestBody body = RequestBody.create(requestBody.toString(), mediaType);\r\n        final Request request = new Request.Builder()\r\n                .url(\"http://vm003.teach.cs.toronto.edu:20112/user\")\r\n                .method(\"POST\", body)\r\n                .addHeader(CONTENT_TYPE_LABEL, CONTENT_TYPE_JSON)\r\n                .build();\r\n        try {\r\n            final Response response = client.newCall(request).execute();\r\n\r\n            final JSONObject responseBody = new JSONObject(response.body().string());\r\n\r\n            if (responseBody.getInt(STATUS_CODE_LABEL) == SUCCESS_CODE) {\r\n                // success!\r\n            }\r\n            else {\r\n                throw new RuntimeException(responseBody.getString(MESSAGE));\r\n            }\r\n        }\r\n        catch (IOException | JSONException ex) {\r\n            throw new RuntimeException(ex);\r\n        }\r\n    }\r\n\r\n    @Override\r\n    public void changePassword(User user) {\r\n        final OkHttpClient client = new OkHttpClient().newBuilder()\r\n                .build();\r\n\r\n        // POST METHOD\r\n        final MediaType mediaType = MediaType.parse(CONTENT_TYPE_JSON);\r\n        final JSONObject requestBody = new JSONObject();\r\n        requestBody.put(USERNAME, user.getUsername());\r\n        requestBody.put(PASSWORD, user.getPassword());\r\n        final RequestBody body = RequestBody.create(requestBody.toString(), mediaType);\r\n        final Request request = new Request.Builder()\r\n                .url(\"http://vm003.teach.cs.toronto.edu:20112/user\")\r\n                .method(\"PUT\", body)\r\n                .addHeader(CONTENT_TYPE_LABEL, CONTENT_TYPE_JSON)\r\n                .build();\r\n        try {\r\n            final Response response = client.newCall(request).execute();\r\n\r\n            final JSONObject responseBody = new JSONObject(response.body().string());\r\n\r\n            if (responseBody.getInt(STATUS_CODE_LABEL) == SUCCESS_CODE) {\r\n                // success!\r\n            }\r\n            else {\r\n                throw new RuntimeException(responseBody.getString(MESSAGE));\r\n            }\r\n        }\r\n        catch (IOException | JSONException ex) {\r\n            throw new RuntimeException(ex);\r\n        }\r\n    }\r\n\r\n//    @Override\r\n    public void updateUser(User user) {\r\n        final OkHttpClient client = new OkHttpClient().newBuilder()\r\n                .build();\r\n\r\n        if (!existsByName(user.getUsername())) {\r\n            throw new RuntimeException(String.format(\"User %s does not exist\", user.getUsername()));\r\n        }\r\n\r\n        // POST METHOD\r\n        final MediaType mediaType = MediaType.parse(CONTENT_TYPE_JSON);\r\n        final JSONObject requestBody = new JSONObject();\r\n\r\n        requestBody.put(USERNAME, user.getUsername());\r\n        requestBody.put(PASSWORD, user.getPassword());\r\n\r\n        final JSONObject infoBody = new JSONObject();\r\n\r\n        infoBody.put(DARK_MODE, user.isDarkMode());\r\n        infoBody.put(CHARACTER_NAME, user.getCharacterName());\r\n        infoBody.put(AVATAR, converter.toJSONObject(user.getAvatar()));\r\n        infoBody.put(HAPPINESS, user.getHappiness());\r\n        infoBody.put(SALARY, user.getSalary());\r\n        infoBody.put(ASSETS, converter.toJSONObject(user.getAssets()));\r\n        infoBody.put(LIABILITIES, converter.toJSONObject(user.getLiabilities()));\r\n        infoBody.put(DECISIONS, converter.toJSONArray(user.getDecisions()));\r\n\r\n        requestBody.put(INFO, infoBody);\r\n\r\n        final RequestBody body = RequestBody.create(requestBody.toString(), mediaType);\r\n        final Request request = new Request.Builder()\r\n                .url(\"http://vm003.teach.cs.toronto.edu:20112/modifyUserInfo\")\r\n                .method(\"PUT\", body)\r\n                .addHeader(CONTENT_TYPE_LABEL, CONTENT_TYPE_JSON)\r\n                .build();\r\n        try {\r\n            final Response response = client.newCall(request).execute();\r\n\r\n            final JSONObject responseBody = new JSONObject(response.body().string());\r\n\r\n            if (responseBody.getInt(STATUS_CODE_LABEL) == SUCCESS_CODE) {\r\n                // success!\r\n            }\r\n            else {\r\n                throw new RuntimeException(responseBody.getString(MESSAGE));\r\n            }\r\n        }\r\n        catch (IOException | JSONException ex) {\r\n            throw new RuntimeException(ex);\r\n        }\r\n    }\r\n\r\n    @Override\r\n    public String getCurrentUsername() {\r\n        return null;\r\n    }\r\n\r\n    public static void main(String[] args) {\r\n        UserFactory userFactory = new CommonUserFactory();\r\n        DBUserDataAccessObject dao = new DBUserDataAccessObject(userFactory);\r\n        User user = userFactory.create(\r\n                \"Paul\",\r\n                \"abc\",\r\n                true,\r\n                \"Joe Roggens\",\r\n                new Avatar(),\r\n                0,\r\n                100000,\r\n                null,\r\n                null,\r\n                new ArrayList<>()\r\n        );\r\n        dao.updateUser(user);\r\n        user = dao.get(\"Paul\");\r\n    }\r\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/src/main/java/data_access/DBUserDataAccessObject.java b/src/main/java/data_access/DBUserDataAccessObject.java
--- a/src/main/java/data_access/DBUserDataAccessObject.java	(revision ef90e6a15318dc37b0d101cfdc55f43b740936a3)
+++ b/src/main/java/data_access/DBUserDataAccessObject.java	(date 1732938731520)
@@ -1,7 +1,18 @@
 package data_access;
 
 import java.io.IOException;
+import java.security.cert.CollectionCertStoreParameters;
+import java.time.LocalDateTime;
+import java.time.format.DateTimeFormatter;
 import java.util.ArrayList;
+import java.util.Collection;
+import java.util.List;
+
+import com.mongodb.client.MongoCollection;
+import com.mongodb.client.model.Filters;
+import com.mongodb.client.model.Updates;
+import entity.Decision;
+import org.json.JSONArray;
 
 import converters.EntityConverterInterface;
 import converters.EntityConverter;
@@ -20,6 +31,8 @@
 import use_case.logout.LogoutUserDataAccessInterface;
 import use_case.signup.SignupUserDataAccessInterface;
 
+import javax.swing.text.Document;
+
 /**
  * The DAO for user data.
  */
@@ -135,6 +148,7 @@
         // this isn't implemented for the lab
     }
 
+
     @Override
     public boolean existsByName(String username) {
         final OkHttpClient client = new OkHttpClient().newBuilder()
@@ -293,14 +307,51 @@
         return null;
     }
 
-    public static void main(String[] args) {
+    public List<Decision> getUserDecisions(String username) {
+        final OkHttpClient client = new OkHttpClient().newBuilder().build();
+        final Request request = new Request.Builder()
+                .url(String.format("http://vm003.teach.cs.toronto.edu:20112/decisions?username=%s", username))
+                .addHeader("Content-Type", CONTENT_TYPE_JSON)
+                .build();
+
+        try {
+            final Response response = client.newCall(request).execute();
+            final JSONObject responseBody = new JSONObject(response.body().string());
+
+            if (responseBody.getInt(STATUS_CODE_LABEL) == SUCCESS_CODE) {
+                final JSONArray decisionsArray = responseBody.getJSONArray("decisions");
+                final List<Decision> decisions = new ArrayList<>();
+
+                for (int i = 0; i < decisionsArray.length(); i++) {
+                    final JSONObject decisionObject = decisionsArray.getJSONObject(i);
+                    final String timestampString = decisionObject.getString("timestamp");
+                    LocalDateTime timestamp = LocalDateTime.parse(timestampString, DateTimeFormatter.ofPattern("MM/dd HH:mm"));
+                    final String decisionText = decisionObject.getString("decisionText");
+                    final String decisionResponse = decisionObject.getString("decisionResponse");
+                    final int happinessImpact = decisionObject.getInt("happinessImpact");
+                    final int netWorthImpact = decisionObject.getInt("netWorthImpact");
+
+                    decisions.add(new Decision(timestamp, decisionText, decisionResponse, happinessImpact, netWorthImpact));
+                }
+
+                return decisions;
+            } else {
+                throw new RuntimeException(responseBody.getString(MESSAGE));
+            }
+        } catch (IOException | JSONException ex) {
+            throw new RuntimeException(ex);
+        }
+    }
+
+}
+    public void main(String[] args) {
         UserFactory userFactory = new CommonUserFactory();
         DBUserDataAccessObject dao = new DBUserDataAccessObject(userFactory);
         User user = userFactory.create(
                 "Paul",
                 "abc",
                 true,
-                "Joe Roggens",
+                "Paulll",
                 new Avatar(),
                 0,
                 100000,
